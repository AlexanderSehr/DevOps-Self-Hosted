{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        // Resource group parameters
        "rgParam": {
            "value": {
                "name": "agents-vmss-rg"
            }
        },
        // Image template parameters
        "itParam": {
            "value": {
                "name": "lin_it",
                "userMsiName": "aibMsi",
                "userMsiResourceGroup": "agents-vmss-rg",
                "imageSource": {
                    "type": "PlatformImage",
                    "publisher": "Canonical",
                    "offer": "UbuntuServer",
                    "sku": "18.04-LTS",
                    "version": "latest"
                    // Custom image example
                    // "type": "SharedImageVersion",
                    // "imageVersionID": "/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/agents-vmss-rg/providers/Microsoft.Compute/galleries/aibgallery/images/linux-sid/versions/0.24469.51608"
                },
                "customizationSteps": [
                    {
                        "type": "Shell",
                        "name": "PowerShell installation",
                        "scriptUri": "https://alsehrcustomsa.blob.core.windows.net/aibscripts/LinuxInstallPowerShell.sh<SAS>"
                    },
                    {
                        "type": "Shell",
                        "name": "Prepare software installation",
                        "inline": [
                            "wget 'https://alsehrcustomsa.blob.core.windows.net/aibscripts/LinuxPrepareMachine.ps1<SAS>' -O 'LinuxPrepareMachine.ps1'",
                            "sed -i 's/\r$//' 'LinuxPrepareMachine.ps1'",
                            "pwsh 'LinuxPrepareMachine.ps1'"
                        ]
                    }
                ],
                "sigImageDefinitionId": "/subscriptions/b765c5e5-ae60-4724-9b59-36fbcf56795b/resourceGroups/agents-vmss-rg/providers/Microsoft.Compute/galleries/aibgallery/images/linux-sid",
                "userAssignedIdentities": "aibMsi"
                // Windows example
                // "imageSource": {
                //     "type": "PlatformImage",
                //     "publisher": "MicrosoftWindowsDesktop",
                //     "offer": "Windows-10",
                //     "sku": "19h2-evd",
                //     "version": "latest"
                //     // Custom image example
                //     // "type": "SharedImageVersion",
                //     // "imageVersionID": "/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/agents-vmss-rg/providers/Microsoft.Compute/galleries/aibgallery/images/windows-sid/versions/0.24470.675"
                // },
                // "customizationSteps": [
                //     {
                //         "type": "PowerShell",
                //         "name": "Software installation",
                //         "scriptUri": "https://<YourStorageAccount>.blob.core.windows.net/aibscripts/WindowsPrepareMachine.ps1<SAS>",
                //         "runElevated": true
                //     }
                // ],
                // "sigImageDefinitionId": "/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/agents-vmss-rg/providers/Microsoft.Compute/galleries/aibgallery/images/windows-sid",
            }
        }
    }
}
